<?php

namespace Moox\Devops\Webhooks;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

class GithubWebhook extends Controller
{
    public function handleGitHub(Request $request)
    {
        $data = $request->all();

        logger()->info('GitHub Webhook', $data);

        /*

        [2024-05-12 23:47:14] production.INFO: GitHub Webhook
        {"ref":"refs/heads/main",
            "before":"c23d5fb97a922fb8859c64b417b25601de9f3225","after":"804a450f9ecf9ec8a1a277cf2f142061a2bcf49c","repository":{"id":748251957,"node_id":"R_kgDOLJlrNQ","name":"moox-server","full_name":"mooxphp/moox-server","private":false,"owner":{"name":"mooxphp","email":null,"login":"mooxphp","id":80827435,"node_id":"MDEyOk9yZ2FuaXphdGlvbjgwODI3NDM1","avatar_url":"https://avatars.githubusercontent.com/u/80827435?v=4","gravatar_id":null,"url":"https://api.github.com/users/mooxphp","html_url":"https://github.com/mooxphp","followers_url":"https://api.github.com/users/mooxphp/followers","following_url":"https://api.github.com/users/mooxphp/following{/other_user}","gists_url":"https://api.github.com/users/mooxphp/gists{/gist_id}","starred_url":"https://api.github.com/users/mooxphp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mooxphp/subscriptions","organizations_url":"https://api.github.com/users/mooxphp/orgs","repos_url":"https://api.github.com/users/mooxphp/repos","events_url":"https://api.github.com/users/mooxphp/events{/privacy}","received_events_url":"https://api.github.com/users/mooxphp/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/mooxphp/moox-server","description":"The Moox Server Monorepo","fork":false,"url":"https://github.com/mooxphp/moox-server","forks_url":"https://api.github.com/repos/mooxphp/moox-server/forks","keys_url":"https://api.github.com/repos/mooxphp/moox-server/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mooxphp/moox-server/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mooxphp/moox-server/teams","hooks_url":"https://api.github.com/repos/mooxphp/moox-server/hooks","issue_events_url":"https://api.github.com/repos/mooxphp/moox-server/issues/events{/number}","events_url":"https://api.github.com/repos/mooxphp/moox-server/events","assignees_url":"https://api.github.com/repos/mooxphp/moox-server/assignees{/user}","branches_url":"https://api.github.com/repos/mooxphp/moox-server/branches{/branch}","tags_url":"https://api.github.com/repos/mooxphp/moox-server/tags","blobs_url":"https://api.github.com/repos/mooxphp/moox-server/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mooxphp/moox-server/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mooxphp/moox-server/git/refs{/sha}","trees_url":"https://api.github.com/repos/mooxphp/moox-server/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mooxphp/moox-server/statuses/{sha}","languages_url":"https://api.github.com/repos/mooxphp/moox-server/languages","stargazers_url":"https://api.github.com/repos/mooxphp/moox-server/stargazers","contributors_url":"https://api.github.com/repos/mooxphp/moox-server/contributors","subscribers_url":"https://api.github.com/repos/mooxphp/moox-server/subscribers","subscription_url":"https://api.github.com/repos/mooxphp/moox-server/subscription","commits_url":"https://api.github.com/repos/mooxphp/moox-server/commits{/sha}","git_commits_url":"https://api.github.com/repos/mooxphp/moox-server/git/commits{/sha}","comments_url":"https://api.github.com/repos/mooxphp/moox-server/comments{/number}","issue_comment_url":"https://api.github.com/repos/mooxphp/moox-server/issues/comments{/number}","contents_url":"https://api.github.com/repos/mooxphp/moox-server/contents/{+path}","compare_url":"https://api.github.com/repos/mooxphp/moox-server/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mooxphp/moox-server/merges","archive_url":"https://api.github.com/repos/mooxphp/moox-server/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mooxphp/moox-server/downloads","issues_url":"https://api.github.com/repos/mooxphp/moox-server/issues{/number}","pulls_url":"https://api.github.com/repos/mooxphp/moox-server/pulls{/number}","milestones_url":"https://api.github.com/repos/mooxphp/moox-server/milestones{/number}","notifications_url":"https://api.github.com/repos/mooxphp/moox-server/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mooxphp/moox-server/labels{/name}","releases_url":"https://api.github.com/repos/mooxphp/moox-server/releases{/id}","deployments_url":"https://api.github.com/repos/mooxphp/moox-server/deployments","created_at":1706197113,"updated_at":"2024-05-12T23:43:47Z","pushed_at":1715557632,"git_url":"git://github.com/mooxphp/moox-server.git","ssh_url":"git@github.com:mooxphp/moox-server.git","clone_url":"https://github.com/mooxphp/moox-server.git","svn_url":"https://github.com/mooxphp/moox-server","homepage":"https://moox.org","size":1746,"stargazers_count":1,"watchers_count":1,"language":"PHP","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["backup","filament","laravel","monorepo","php","server"],"visibility":"public","forks":0,"open_issues":3,"watchers":1,"default_branch":"main","stargazers":1,"master_branch":"main","organization":"mooxphp","custom_properties":[]},"pusher":{"name":"adrolli","email":"40421928+adrolli@users.noreply.github.com"},"organization":{"login":"mooxphp","id":80827435,"node_id":"MDEyOk9yZ2FuaXphdGlvbjgwODI3NDM1","url":"https://api.github.com/orgs/mooxphp","repos_url":"https://api.github.com/orgs/mooxphp/repos","events_url":"https://api.github.com/orgs/mooxphp/events","hooks_url":"https://api.github.com/orgs/mooxphp/hooks","issues_url":"https://api.github.com/orgs/mooxphp/issues","members_url":"https://api.github.com/orgs/mooxphp/members{/member}","public_members_url":"https://api.github.com/orgs/mooxphp/public_members{/member}","avatar_url":"https://avatars.githubusercontent.com/u/80827435?v=4","description":"Work in progress"},"sender":{"login":"adrolli","id":40421928,"node_id":"MDQ6VXNlcjQwNDIxOTI4","avatar_url":"https://avatars.githubusercontent.com/u/40421928?v=4","gravatar_id":null,"url":"https://api.github.com/users/adrolli","html_url":"https://github.com/adrolli","followers_url":"https://api.github.com/users/adrolli/followers","following_url":"https://api.github.com/users/adrolli/following{/other_user}","gists_url":"https://api.github.com/users/adrolli/gists{/gist_id}","starred_url":"https://api.github.com/users/adrolli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrolli/subscriptions","organizations_url":"https://api.github.com/users/adrolli/orgs","repos_url":"https://api.github.com/users/adrolli/repos","events_url":"https://api.github.com/users/adrolli/events{/privacy}","received_events_url":"https://api.github.com/users/adrolli/received_events","type":"User","site_admin":false},"created":false,"deleted":false,"forced":false,"base_ref":null,"compare":"https://github.com/mooxphp/moox-server/compare/c23d5fb97a92...804a450f9ecf","commits":[{"id":"804a450f9ecf9ec8a1a277cf2f142061a2bcf49c","tree_id":"b7865ddcdeb6c8362679351ffd084873a362a583","distinct":true,"message":"Update ForgeWebhook.php","timestamp":"2024-05-13T01:47:10+02:00","url":"https://github.com/mooxphp/moox-server/commit/804a450f9ecf9ec8a1a277cf2f142061a2bcf49c","author":{"name":"Alf Drollinger","email":"alf@drollinger.info","username":"adrolli"},"committer":{"name":"Alf Drollinger","email":"alf@drollinger.info","username":"adrolli"},"added":[],"removed":[],"modified":["packages/devops/src/Webhooks/ForgeWebhook.php"]}],"head_commit":{"id":"804a450f9ecf9ec8a1a277cf2f142061a2bcf49c","tree_id":"b7865ddcdeb6c8362679351ffd084873a362a583","distinct":true,"message":"Update ForgeWebhook.php","timestamp":"2024-05-13T01:47:10+02:00","url":"https://github.com/mooxphp/moox-server/commit/804a450f9ecf9ec8a1a277cf2f142061a2bcf49c","author":{"name":"Alf Drollinger","email":"alf@drollinger.info","username":"adrolli"},"committer":{"name":"Alf Drollinger","email":"alf@drollinger.info","username":"adrolli"},"added":[],"removed":[],"modified":["packages/devops/src/Webhooks/ForgeWebhook.php"]}}


        */
    }
}
